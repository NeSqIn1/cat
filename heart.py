import logging
import os
import random
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, ContextTypes, filters

# Получаем настройки из переменных окружения
TOKEN = os.environ.get("TELEGRAM_BOT_TOKEN")
TARGET_USER_ID = int(os.environ.get("TARGET_USER_ID", "0"))
OWNER_ID = int(os.environ.get("OWNER_ID", "0"))

# Настройка логирования
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO
)
logger = logging.getLogger(__name__)

# Список из 100 нежных признаний без нумерации
messages = [
    "Ты согрреваешь моё сердце, котик!",
    "Каждый раз, когда я вижу тебя, я таю, котик!",
    "Твоё присутствие — мой самый дорогой подарок, котик!",
    "С тобой мир становится ярче, котик!",
    "Ты — лучик солнца в моём дне, котик!",
    "Я не устаю любоваться тобой, котенок!",
    "Твоя улыбка — моя слабость, котик!",
    "Моё сердце бьётся чаще рядом с тобой, котик!",
    "Ты делаешь мою жизнь волшебной, котик!",
    "Я люблю каждое мгновение с тобой, котик!",
    "С тобой я забываю обо всём на свете, котик!",
    "Ты красива, котеночек, как рассвет!",
    "Каждое твоё слово — музыка для моей души, котик!",
    "С тобой я чувствую себя дома, котик!",
    "Ты — мой самый заветный сон, котик!",
    "Каждый день с тобой — праздник, котик!",
    "Я дорожу каждой секундой рядом с тобой, котик!",
    "Ты — моя главная мысль утром и вечером, котик!",
    "В твоих объятиях я нахожу покой!!!!!",
    "Ты — моё вдохновение, котик!",
    "Мои чувства к тебе безграничны, котик!",
    "Я счастлив, что ты у меня есть, котик!",
    "С каждым днём люблю тебя сильнее, котик!",
    "Ты наполняешь мою жизнь смыслом, котик!",
    "Я хочу делать тебя счастливой, котик!!!!!",
    "Ты — моя нежность, котик!!!!!!!!!",
    "В твоих глазах я вижу своё будущее, котик!",
    "Люблю твой смех, котик!",
    "Ты — моя радость, котик!",
    "Моё сердце принадлежит только тебе, котик!",
    "Ты — самая красивая часть моего каждого дня, котик!",
    "С тобой я летаю от счастья, котик!",
    "Ты делаешь меня лучше, котик!",
    "Я скучаю по тебе каждую секунду, котик!",
    "Ты — моя сказка, котик!",
    "Моё счастье — это ты, котик!",
    "Ты — моя нежная мелодия, котик!",
    "Я храню тепло твоих прикосновений, котик!",
    "Ты — свет в моём сердце, котик!",
    "Моё сердце поёт для тебя, котик!",
    "Ты — моё всё, котик!",
    "Я люблю твой голос, котик!",
    "С тобой я забываю обо всех проблемах, котик!",
    "Ты делаешь каждый день особенным, котик!",
    "Я хочу быть рядом вечно, котик!",
    "Ты — моя нежная грёза, котик!",
    "Моё сердце бьётся только для тебя, котик!",
    "Ты — моя гармония, котик!",
    "Я наполняюсь счастьем рядом с тобой, котик!",
    "Ты вдохновляешь меня мечтать, котик!",
    "Моё сердце тает от твоих поцелуев, котик!",
    "Ты — моя звезда, котик!",
    "С тобой любое место становится домом, котик!",
    "Я хочу смотреть в твои глаза вечно, котик!",
    "Ты — моё солнце в пасмурный день, котик!",
    "Я люблю, когда ты смеёшься, котик!",
    "Ты — моя самая красивая мысль, котик!",
    "Моё сердце поёт, когда ты рядом, котик!",
    "Ты делаешь мою жизнь полной, котик!",
    "Я в восторге от твоей доброты, котик!",
    "Ты — моя радость и покой, котик!",
    "Я хочу дарить тебе счастье, котик!",
    "Ты делаешь моё сердце мягким, котик!",
    "Моя любовь к тебе — бесконечность, котик!",
    "Ты — мой самый дорогой человек, котик!",
    "С тобой я чувствую себя особенным, котик! (ну прям оченьььь)",
    "Я люблю твои глазки, котик!",
    "Ты — моя нежная весна, котик!",
    "Моё сердце переполнено тобой, котик!",
    "Ты — моя радужная мечта, котик!",
    "Я счастлив, когда ты счастлива, котик!",
    "Ты — мой ангел, котик!",
    "Моя душа светится от твоей любви, котик!",
    "Ты — моя энергия, котик!",
    "Я влюблён в каждую черточку твоего лица, котик!(ну правда)",
    "Ты — моё безмятежное счастье, котик!",
    "Я люблю тебя до луны и обратно, котик!",
    "Ты — моя тихая гавань, котик!",
    "Моё сердце принадлежит только тебе, котик!",
    "Ты — моя бесконечная сказка, котик!",
    "Я дышу тобой, котик!",
    "Ты — моя радуга после дождя, котик!",
    "Моё сердце радуется, когда ты рядом, котик!",
    "Ты — моя вечная песня, котик!",
    "Я люблю твои теплые ладони, котик!",
    "Ты — моя самая нежная мысль, котик!",
    "Моё счастье начинается с тебя, котик!",
    "Ты — моя главная ценность, котик!",
    "Я в восторге от твоей улыбки, котик!",
    "Ты — моё вдохновение и покой, котик!",
    "Моё сердце поет от твоей любви, котик!",
    "Ты самый шикарный котик в галактике!",
    "мрр~"
]


# Функция отправки признания
async def send_love(context: ContextTypes.DEFAULT_TYPE):
    msg = random.choice(messages)
    await context.bot.send_message(chat_id=TARGET_USER_ID, text=msg)


# Команда /start для запуска
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("йоооо, каждый час ты будешь чувствовать мою любовь <3")
    context.job_queue.run_repeating(send_love, interval=1, first=1)


# Пересылка всех входящих текстовых сообщений владельцу
async def forward_to_owner(update: Update, context: ContextTypes.DEFAULT_TYPE):
    try:
        await context.bot.forward_message(
            chat_id=OWNER_ID,
            from_chat_id=update.message.chat_id,
            message_id=update.message.message_id
        )
    except Exception as e:
        logger.error(f"Ошибка при пересылке сообщения: {e}")


if __name__ == '__main__':
    app = ApplicationBuilder().token(TOKEN).build()
    app.add_handler(CommandHandler('start', start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, forward_to_owner))
    app.run_polling()
